# ABM ‚Äî Async Bridge Manager

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π backend-–ø—Ä–æ–µ–∫—Ç –Ω–∞ FastAPI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏, –∞ —Ç–∞–∫–∂–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π Telegram –Ω–∞ Email
(—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Telegram-–±–æ—Ç–∞ –∏ Email).

üìå **–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ**

- –û–ø–∏—Å–∞–Ω–∏–µ
- –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫
 - –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
 - –ó–∞–ø—É—Å–∫ –≤ Docker
 - –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Production)
- Ci/CD
- To Do
- –ê–≤—Ç–æ—Ä

---

## üß© –û–ø–∏—Å–∞–Ω–∏–µ

**ABM (Async Bridge Manager)** ‚Äî –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–µ–∫—Ç, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–π:

- –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π backend –Ω–∞ FastAPI
- —Ä–∞–±–æ—Ç—É —Å PostgreSQL —á–µ—Ä–µ–∑ SQLAlchemy Async
- –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ Telegram-–±–æ—Ç–∞ —Å backend –ø–æ REST API
- –æ—Ç–ø—Ä–∞–≤–∫—É —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á –∏ –∑–∞–¥–∞—á –æ—Ç–¥–µ–ª—å–Ω–æ –Ω–∞ Email
- –ø–µ—Ä–µ—Å—ã–ª–∫—É –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Telegram –Ω–∞ Email

–ü—Ä–æ–µ–∫—Ç –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
–∏ production-–ø–æ–¥—Ö–æ–¥ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Python >=3.12,<3.15
- FastAPI ^0.124.0 ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π web-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- Uvicorn ^0.38.0 ‚Äî ASGI-—Å–µ—Ä–≤–µ—Ä
- SQLAlchemy ^2.0.45 ‚Äî ORM (Async)
- asyncpg ^0.31.0 ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π PostgreSQL-–¥—Ä–∞–π–≤–µ—Ä
- Alembic ^1.17.2 ‚Äî –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- Pydantic Settings ^2.12.0 ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- aiogram ^3.23.0 ‚Äî Telegram-–±–æ—Ç (async)
- httpx ^0.28.1 ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π HTTP-–∫–ª–∏–µ–Ω—Ç
- aiohttp ^3.13.2 ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ HTTP-–∑–∞–ø—Ä–æ—Å—ã
- aiosmtplib ^5.0.0 ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ Email
- Jinja2 ^3.1.6 ‚Äî HTML-—à–∞–±–ª–æ–Ω–∏–∑–∞—Ü–∏—è –ø–∏—Å–µ–º
- Loguru ^0.7.3 ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- pytest ^9.0.2 ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- pytest-asyncio ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- pytest-cov ‚Äî –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ —Ç–µ—Å—Ç–∞–º–∏
- Docker / Docker Compose
- GitHub Actions - CI/CD

---

## üßë‚Äçüíª –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

- CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∑–∞–¥–∞—á
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π REST API
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ Telegram user_id
- Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏
- FSM-—Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤ Telegram-–±–æ—Ç–µ
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á –ø–æ Email
- –û—Ç–ø—Ä–∞–≤–∫–∞ –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏ –ø–æ Email
- –ü–µ—Ä–µ—Å—ã–ª–∫–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Telegram –Ω–∞ Email
- HTML-—à–∞–±–ª–æ–Ω—ã –ø–∏—Å–µ–º
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –∏ –æ—à–∏–±–æ–∫
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (pytest)

---

## üìÅ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:

–ü—Ä–∏–Ω—Ü–∏–ø—ã:

- –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
- dependency injection
- models ‚Üí services ‚Üí routers
- –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –±–æ—Ç–∞ –∫ –ë–î
- –ª—ë–≥–∫–∞—è —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å

---

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

#### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
git clone https://github.com/EugenyBaz/ABM.git

cd ABM
#### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
poetry install
#### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
—Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª .env  
BOT_TOKEN=  
POSTGRES_PASSWORD=  
SMTP_HOST=  
SMTP_PORT=  
SMTP_USER=  
SMTP_PASSWORD=  
API_URL=  
REPORT_EMAIL=  
ALLOWED_FORWARD_USERS=  
MARKETING_EMAIL_SUBJECT=  
DATABASE_URL=  

##### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π 
alembic upgrade head

#### 4. –ó–∞–ø—É—Å–∫ backend
uvicorn app.main:app --reload

üëâ http://127.0.0.1:8000

üëâ Swagger: http://127.0.0.1:8000/docs

#### 5. –ó–∞–ø—É—Å–∫ Telegram-–±–æ—Ç–∞
python -m app.bot.run_bot

### –ó–∞–ø—É—Å–∫ –≤ Docker(–ª–æ–∫–∞–ª—å–Ω–æ)
docker compose up --build

### üöÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Production)

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ VPS —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker Compose
–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ GitHub Actions.

#### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:  
Docker  
Docker Compose  
–°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞:  
mkdir ~/abm  
cd ~/abm

#### 2. –§–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —Ö—Ä–∞–Ω—è—Ç—Å—è:  
docker-compose.prod.yaml  
.env.prod  
.env.prod.example  
–ü—Ä–∏–º–µ—Ä  .env.prod:   
DATABASE_URL=postgresql+asyncpg://{POSTGRES_USER}:{POSTGRES_PASSWORD}@db:5432/{POSTGRES_DB}
POSTGRES_DB=  
POSTGRES_USER=  
POSTGRES_PASSWORD=  

BOT_TOKEN=...  
SMTP_HOST=...  
SMTP_PORT=...  
SMTP_USER=...  
SMTP_PASSWORD=...
API_URL=http://<SERVER_IP>:8000
REPORT_EMAIL=...

#### 3. –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (–æ–¥–∏–Ω —Ä–∞–∑)
docker compose -f docker-compose.prod.yaml pull  
docker compose -f docker-compose.prod.yaml up -d

#### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ 
docker ps

API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É 
http://<SERVER_IP>:8000/docs

## üîÅ CI/CD

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω CI/CD pipeline —á–µ—Ä–µ–∑ GitHub Actions:  
–∑–∞–ø—É—Å–∫ –ª–∏–Ω—Ç–µ—Ä–∞  
–∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤  
—Å–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–∞  
push –≤ Docker Hub  
–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ VPS –ø–æ SSH  
–î–µ–ø–ª–æ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–µ—Ç–∫–∏ main.  

## üìù To Do

- —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã

## üë§ –ê–≤—Ç–æ—Ä

–ï–≤–≥–µ–Ω–∏–π –ë–∞–∑–∞–≤–æ–¥ ‚Äî Backend Developer

